import t,{useReducer as r,useEffect as e,cloneElement as n,createContext as o,useContext as u,useRef as a,useState as i,useCallback as l,isValidElement as c,useMemo as f}from"react";import{View as s,Pressable as p}from"react-native";var d=function(){return d=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var o in r=arguments[e])Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);return t},d.apply(this,arguments)};function y(t,r,e){if(e||2===arguments.length)for(var n,o=0,u=r.length;o<u;o++)!n&&o in r||(n||(n=Array.prototype.slice.call(r,0,o)),n[o]=r[o]);return t.concat(n||Array.prototype.slice.call(r))}var m,v=function(t){return t.filter((function(t){return!!t.status})).sort((function(t,r){return t.updatedOn>r.updatedOn?1:t===r?0:-1}))},g=function(t,r){return(null==r?void 0:r.length)!==(null==t?void 0:t.length)?r:t},h=function(o){var u=o.layers,a=o.closeLayerByUuid,i=r(g,v(u)),l=i[0],c=void 0===l?[]:l,f=i[1];e((function(){f(v(u))}),[u]);var y={modal:{alignItems:"center",justifyContent:"center"},default:{},bottom:{justifyContent:"flex-end"}};return t.createElement(t.Fragment,null,c.map((function(r){var e=r.layerUuid,o=r.component,u=r.orientation,i=void 0===u?"modal":u,l=i&&y[i]?y[i]:y.default;return t.createElement(s,{key:e,style:d(d({},l),{display:"flex",flexDirection:"column",position:"absolute",top:"0px",right:"0px",bottom:"0px",left:"0px",overflow:"auto",backgroundColor:"transparent"})},t.createElement(p,{style:{position:"absolute",top:"0px",right:"0px",bottom:"0px",left:"0px",backgroundColor:"rgba(0, 0, 0, 0.5)"},onPress:function(){return e&&a(e)}}),n(o,d(d(d({},o.props),{style:d(d({},o.props.style),{backgroundColor:"#FF0000",position:"relative"})}),r)))})))},b=new Uint8Array(16);function x(){if(!m&&!(m="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return m(b)}var w=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function C(t){return"string"==typeof t&&w.test(t)}for(var U=[],E=0;E<256;++E)U.push((E+256).toString(16).substr(1));function L(t,r,e){var n=(t=t||{}).random||(t.rng||x)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,r){e=e||0;for(var o=0;o<16;++o)r[e+o]=n[o];return r}return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=(U[t[r+0]]+U[t[r+1]]+U[t[r+2]]+U[t[r+3]]+"-"+U[t[r+4]]+U[t[r+5]]+"-"+U[t[r+6]]+U[t[r+7]]+"-"+U[t[r+8]]+U[t[r+9]]+"-"+U[t[r+10]]+U[t[r+11]]+U[t[r+12]]+U[t[r+13]]+U[t[r+14]]+U[t[r+15]]).toLowerCase();if(!C(e))throw TypeError("Stringified UUID is invalid");return e}(n)}var O=o({layers:[]}),j=function(){var t=u(O);if(void 0===t)throw new Error("useLayer was used outside of its Provider");return t},R=function(r){var o=r.children,u=a([]),s=i([]),p=s[0],d=s[1],m=l((function(t){return void 0===t&&(t=""),d(p.filter((function(r){return r.layerUuid!==t})))}),[p]),v=l((function(t){return d(p.filter((function(r){return r.name!==t})))}),[p]),g=l((function(){return d([])}),[]),b=l((function(t,r){var e=t.component,o=t.name,a=t.orientation,i=void 0===a?"full":a,l=L(),f={name:o,layerUuid:l,orientation:i,status:1,updatedOn:Date.now(),component:c(e)&&n(e,{layerUuid:l})};d((function(t){return y(y([],t,!0),[f],!1)})),r&&u.current.push(r)}),[]);e((function(){u.current.forEach((function(t){return t()})),u.current=[]}),[p]);var x=f((function(){return{layers:p,createLayer:b,closeLayerByUuid:m,closeLayerByName:v,closeAllLayers:g}}),[p,b,m,v,g]),w=p.sort((function(t,r){return t.updatedOn<r.updatedOn?-1:t===r?0:1})).filter((function(t){return!!t.status}));return t.createElement(O.Provider,{value:x},o,!!(null==w?void 0:w.length)&&t.createElement(h,{layers:w,closeLayerByUuid:m}))};export{R as LayersProvider,j as useLayer};
//# sourceMappingURL=index.js.map
