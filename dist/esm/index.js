import e,{useReducer as t,useEffect as n,cloneElement as r,createContext as o,useContext as a,useRef as u,useState as i,useCallback as l,isValidElement as c,useMemo as f}from"react";import{StyleSheet as s,View as d,Pressable as p}from"react-native";var y=function(){return y=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},y.apply(this,arguments)};function x(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var m=function(e){return e.filter((function(e){return!!e.status})).sort((function(e,t){return e.updatedOn>t.updatedOn?1:e===t?0:-1}))},v=function(e,t){return(null==t?void 0:t.length)!==(null==e?void 0:e.length)?t:e},g=function(o){var a=o.layers,u=o.closeLayerByUuid,i=t(v,m(a)),l=i[0],c=void 0===l?[]:l,f=i[1];n((function(){f(m(a))}),[a]);var s={modal:{alignItems:"center",justifyContent:"center"},default:{},bottom:{justifyContent:"flex-end"}};return e.createElement(e.Fragment,null,c.map((function(t){var n=t.layerUuid,o=t.component,a=t.orientation,i=void 0===a?"modal":a,l=i&&s[i]?s[i]:s.default;return e.createElement(d,{key:n,style:y(y({},l),h.container)},e.createElement(p,{style:h.closable,onPress:function(){return n&&u(n)}}),r(o,y(y(y({},o.props),{style:y(y({},o.props.style),h.component)}),t)))})))},h=s.create({container:{display:"flex",flexDirection:"column",position:"absolute",top:0,right:0,bottom:0,left:0,overflow:"scroll",backgroundColor:"transparent"},closable:{position:"absolute",top:0,right:0,bottom:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)"},component:{backgroundColor:"#FF0000",position:"relative"}}),b=o({layers:[]}),w=function(){var e=a(b);if(void 0===e)throw new Error("useLayer was used outside of its Provider");return e},O=function(t){var o=t.children,a=u([]),s=i([]),d=s[0],p=s[1],y=l((function(e){return void 0===e&&(e=""),p(d.filter((function(t){return t.layerUuid!==e})))}),[d]),m=l((function(e){return p(d.filter((function(t){return t.name!==e})))}),[d]),v=l((function(){return p([])}),[]),h=l((function(e,t){var n,o,u=e.component,i=e.name,l=e.orientation,f=void 0===l?"full":l,s=(n=(new Date).getTime(),o="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0,"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random();return n>0?(t=(n+t)%16|0,n=Math.floor(n/16)):(t=(o+t)%16|0,o=Math.floor(o/16)),("x"===e?t:3&t|8).toString(16)}))),d={name:i,layerUuid:s,orientation:f,status:1,updatedOn:Date.now(),component:c(u)&&r(u,{layerUuid:s})};p((function(e){return x(x([],e,!0),[d],!1)})),t&&a.current.push(t)}),[]);n((function(){a.current.forEach((function(e){return e()})),a.current=[]}),[d]);var w=f((function(){return{layers:d,createLayer:h,closeLayerByUuid:y,closeLayerByName:m,closeAllLayers:v}}),[d,h,y,m,v]),O=d.sort((function(e,t){return e.updatedOn<t.updatedOn?-1:e===t?0:1})).filter((function(e){return!!e.status}));return e.createElement(b.Provider,{value:w},o,!!(null==O?void 0:O.length)&&e.createElement(g,{layers:O,closeLayerByUuid:y}))};export{O as LayersProvider,w as useLayer};
//# sourceMappingURL=index.js.map
